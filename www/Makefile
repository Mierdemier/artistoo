all : index.html manual/asset


always :
	echo "building website from scratch"

# Step 1 : Build main site with mustache

../mustache-web/public/layout.html : always
	cd ../mustache-web && $(MAKE) -B

# Step 2 : Port mustache-generated layout to mytemplate
../esdoc-template-artistoo/layout.html : ../mustache-web/public/layout.html
	cp $< $@

# Step 3 : Auto-build documentation with esdoc; this contains:
#	- "Documentation"
#	- "Source"
#	- "Tests"
#	- link to github
#	- search index of all the auto-generated pages.
esdoc-build : ../esdoc-template-artistoo/layout.html
		
#cd .. && $(MAKE) docs/index.html -B
	

# Step 4: copy all esdoc stuff into this folder:
identifiers.html : ../docs/index.html esdoc-build
	cp -r ../docs/* .
	

# Step 5: add mustache-generated stuff (which includes an index.html to overwrite
# the one generated by esdoc, so this step should come after copying the esdoc stuff.)
index.html : ../mustache-web/public/index.html identifiers.html
	cp -r ../mustache-web/public/* .
	


# Step 6: add extra files such as examples and manual assets
manual/asset : ../mustache-web/sources/manual/asset index.html
	cp -r $< $@